{% extends 'dashboard.html' %}
{% block title %}<title>Notes App</title>{% endblock %}
{% block addcss %}
<link rel="stylesheet" href="/static/addnotes.css">
{% endblock %}

{% block content %}
<div class="container">
    <h2>My Notes</h2>

    <form method="post" id="noteForm">
        <div class="form-group">
            <input type="text" name="title" id="title" value="{{notesdata[1]}}">
        </div>

        <div class="form-group">
            <textarea id="content" name="content" >{{notesdata[2]}}</textarea>
        </div>

        <button type="submit">Update Note</button>
    </form>

    <div class="notes" id="notesList"></div>
</div>

<script>
document.getElementById("noteForm").addEventListener("submit", function(e) {
    e.preventDefault();

    const title = document.getElementById("title").value.trim();
    const content = document.getElementById("content").value.trim();

    if (title === "" || content === "") {
        alert("Please fill in both fields!");
        return;
    }

    fetch("{{ url_for('updatenotes',nid=nid) }}", {
        method: "PUT",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify({
            title: title,
            content: content
        })
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            const note = document.createElement("div");
            note.classList.add("note");
            note.innerHTML = `
                <h3>${title}</h3>
                <p>${content}</p>
            `;
            document.getElementById("notesList").appendChild(note);

            document.getElementById("title").value = "";
            document.getElementById("content").value = "";
        } else {
            alert("Error saving note");
        }
    })
    .catch(error => console.error("Error:", error));
});
</script>
{% endblock %}
